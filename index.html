<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<!--metatextblock-->
		<title>D3usN0tam System</title>
		<meta name="description" content="Модификации от Deus Notam">
		<meta property="og:title" content="D3usN0tam System">
		<meta property="og:description" content="Модификации от Deus Notam">
		<meta property="og:type" content="website">
		<meta property="og:image" content="site/img/logo.jpeg">
		<!--/metatextblock-->
		<link rel="icon" type="image/png" sizes="32x32" href="site/img/logo.jpeg">
		<!-- Assets -->
		<link rel="stylesheet" href="site/css/style.css">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.10.0/bootstrap-table.min.css">
		<link rel="stylesheet" href="https://rawgit.com/vitalets/x-editable/master/dist/bootstrap3-editable/css/bootstrap-editable.css">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.10.0/bootstrap-table.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.9.1/extensions/filter-control/bootstrap-table-filter-control.js"></script>
		<script src="datasite.js"></script>
	</head>
	<body>
		<div class="popup" id="loginPopup">
			<div class="login">
				<div class="logintext">DeusID</div>
				<div class="field">
					<input type="text" placeholder="" name="login">
					<div class="placeholder">Логин</div>
				</div>
				<div class="field">
					<input type="password" placeholder="" name="password">
					<div class="placeholder">Пароль</div>
				</div>
				<div class="error">
							<span class="errortext"></span>
						</div>
				<div class="loginbtn">Войти</div>
			</div>
		</div>
    
		<div class="menu">
			<div class="logo">
				<div class="themeswitcher">
					<label class="switcher">
						<div>
							<a href="https://deusnotam.notion.site/D3usNotam-System-ba149f69de214fd3ba0b9df834eb2c6e?pvs=4" target="_blank">
								<img class="logoimg" src="site/img/logo.jpeg">
							</a>
						</div>
					</label>
				</div>
			</div>

			<div class="button">
				<div class="themeswitcher">
					<label class="switcher">
						<div>
							<a href="https://deusnotam.notion.site/05f47625ac2f4a1eb47db6e1830a02c5?pvs=4" class="text instructions" target="_blank">
								<span>Инструкция</span>
							</a>
						</div>
					</label>
				</div>
			</div>
			
			<div class="button">
				<div class="themeswitcher">
					<label class="switcher">
						<div>
							<a href="https://deusnotam.notion.site/00f3d2d7f4914bbfa3e4b923dfae8106?pvs=4" class="text update" target="_blank">
								<span>Что нового?</span>
							</a>
						</div>
					</label>
				</div>
			</div>
			
			<div class="loginico" id="loginico">
				<div class="themeswitcher">
					<label class="switcher">
						<div>
							<svg viewBox="0 0 64.00 64.00" fill="none" stroke="var(--txt-color)" stroke-width="3.2">
								<polyline points="16 20 16 8 48 8 48 56 16 56 16 44"></polyline>
								<polyline points="28 40 36 32 28 24"></polyline>
								<line x1="8" y1="32" x2="36" y2="32"></line>
                  
							</svg>
						</div>
					</label>
				</div>
			</div>
			<script>
				document.getElementById('loginico').addEventListener('click', function() {
					document.getElementById('loginPopup').classList.add('show');
				});
				window.addEventListener('click', function(event) {
					if (event.target === document.getElementById('loginPopup')) {
						document.getElementById('loginPopup').classList.remove('show');
					}
				});
			</script>
			<script>
				document.addEventListener('DOMContentLoaded', function () {
    document.querySelector('.loginbtn').addEventListener('click', function () {
        var loginField = document.querySelector('input[type="text"]');
        var passwordField = document.querySelector('input[type="password"]');
        var errorText = document.querySelector('.errortext');
        var errorDiv = document.querySelector('.error');

        if (loginField.value === '' || passwordField.value === '') {
            errorText.innerText = 'Одно из полей пустое';
            errorDiv.style.display = 'block';
            return;
        }

        errorText.innerText = '';
        errorDiv.style.display = 'none';

        var webhookURL = 'https://hook.eu2.make.com/jfk4pee4p1k92avnsasm7mmvp9bamxcf';
        var requestData = {
            login: loginField.value,
            password: passwordField.value
        };

        // Сохраняем данные из ответа в переменные
        var customHeaders = {};

        fetch(webhookURL, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestData)
        })
            .then(response => {
                if (response.status === 201) {
                    errorText.innerText = 'Не верный логин или пароль';
                    errorDiv.style.display = 'block';
                }
                if (response.status === 202) {
                    // Используем данные для установки кастомных заголовков
                    customHeaders.Name = response.headers.get('Name');
                    customHeaders.Site = response.headers.get('Site');
                    return response.text(); // Возвращаем Promise с данными из ответа
                }
            })
            .then(data => {
                console.log('Данные с вебхука:', data);
                console.log('Custom Headers:', customHeaders);
            })
            .catch(error => {
                console.log('Произошла ошибка при отправке данных на вебхук', error);
            });
    });
});
			</script>
		</div>
		
		<div class="container">
			<h1>D3usN0tam System</h1>
			<p>Это система собирающая в себе много модификаций. Увидеть все доступные модификации можно кликнув по логотипу сверху.</p>
			<p>Здесь можно увидеть проекты, которые были подключены к системе D3usN0tam.</p>
			<p>Все подробности о проекте можно найти кликнув по логотипу сверху.</p>

			<table id="table" data-toggle="table" data-search="false" data-filter-control="true" data-show-export="false" data-click-to-select="true" data-toolbar="#toolbar">
				<thead>
					<tr>
						<th data-field="name" data-filter-control="input" data-sortable="true">Название</th>
						<th data-field="link" data-sortable="false">Ссылка</th>
						<th data-field="date" data-filter-control="select" data-sortable="true">Дата подключения</th>
						<th data-field="noti" data-filter-control="select" data-sortable="true">Cистема "Noti"</th>
						<th data-field="blocker" data-filter-control="select" data-sortable="true">Cистема "Blocker"</th>
					</tr>
				</thead>
				<tbody id="tableBody">
					
				</tbody>
			</table>
			<script>
				$(document).ready(function () {
					var $table = $('#table');
					function processData(data) {
						$table.bootstrapTable('destroy');
						$table.bootstrapTable({
							data: site,
							columns: [
								{ field: 'name', title: 'Название', sortable: true },
								{ field: 'url', title: 'Ссылка', sortable: false },
								{ field: 'date', title: 'Дата подключения', sortable: true },
								{ field: 'noti', title: 'Cистема "Noti"', sortable: true },
								{ field: 'blocker', title: 'Cистема "Blocker"', sortable: true,
								 formatter: function (value, row, index) {
									 var blockerNote = row.blocker_note || '';
									 return '<div data-toggle="tooltip" data-placement="auto" title="' + blockerNote + '">' + value + '</div>';
								 }
								},
							]
						});
						$('[data-toggle="tooltip"]').tooltip();
					}
					processData(site);
				});
			</script>
			<script>
				function setTheme() {
					var now = new Date();
					var hours = now.getHours();
        
					if (hours >= 6 && hours < 18) {
						document.documentElement.setAttribute('data-theme', 'light');
					} else {
						document.documentElement.setAttribute('data-theme', 'dark');
					}
				}
				
				setTheme();
				
				setInterval(setTheme, 3600000);
			</script>

		</div>
	</body>
</html>
